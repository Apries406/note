# 1.简述TCP连接过程

TCP协议通过三次握手建立可靠的点对点连接，具体过程是：
1. 首先服务器进入监听状态，然后即可处理连接
2. 第一次握手：建立连接时，客户端发送`syn`包到服务器，并进入`SYN_SENT`状态，等待服务器确认。在发送的包中还会包含一个初始序列号`seq`。此次握手的含义是客户端希望与服务器建立连接。
3. 第二次握手：服务器收到`syn`包，然后回应给客户端一个`syn + ack`包，此时服务器进入`SYN_RCVD`状态。此次握手的含义是服务端回应客户端，表示已经收到并同意客户端的连接请求。
4. 第三次握手：客户端收到服务器的`syn`包后，向服务器再次发送`ack`包，并进入`ESTAB_LISHED`状态
5. 最后，服务端收到客户端的`ack`包，于是也进入`ESTAB_LISHED`状态，至此，连接建立完成。
## 为什么不两次握手？

**三次握手的目的是防止已经失效的连接请求突然又回到服务端，产生错误**

假设采用两次握手建立连接，客户端第一次向服务器发送建立连接请求，因为网络延迟原因，一直没有到达服务器。于是客户端再次向服务端发送建立连接请求，这次服务端收到连接请求后，向客户端回复确认，建立连接。但是这时网络延迟的那个请求恢复，服务端又收到客户端第一次发送的连接请求，服务端认为客户端又发起了一次连接，再次回复确认，又建立了一个连接。

此时服务端认为有两个连接，客户端认为有一个连接，造成数据状态不一致。

至于为什么不像断开连接一样采用"四次握手"，因为服务端把确认连接请求和向客户端发送的建立连接请求合并为一次请求，发送给客户端了。