# äº‹ä»¶å†’æ³¡
## ä»€ä¹ˆæ˜¯äº‹ä»¶å†’æ³¡ï¼Ÿ
åœ¨htmlæœ‰è¿™æ ·ä¸€ä¸ªç°è±¡:
![[Pasted image 20240510205617.png]]
åœ¨æˆ‘ä»¬ç‚¹å‡»`div3`åï¼Œå‘ç°`div3`çš„`click`äº‹ä»¶è¢«è§¦å‘åè¿˜è§¦å‘äº†ä»–çš„çˆ¶å…ƒç´ çš„`click`äº‹ä»¶ã€‚è¿™å°±æ˜¯äº‹ä»¶å†’æ³¡ã€‚

>[!info]
>äº‹ä»¶å†’æ³¡: å½“æŸå…ƒç´ æ‰§è¡ŒæŸä¸€ç§ç±»å‹äº‹ä»¶,é‚£ä¹ˆä»è¯¥å…ƒç´ èµ·é€çº§å‘å¤–å±‚çš„å…ƒç´ æ£€æµ‹æ˜¯å¦å­˜åœ¨æœ¬èº«åŒæ ·çš„äº‹ä»¶.

# äº‹ä»¶æ•è·
## ä»€ä¹ˆæ˜¯äº‹ä»¶æ•è·?
>[!info]
>äº‹ä»¶æ•è·ï¼šå½“æŸå…ƒç´ è§¦å‘äº‹ä»¶æ—¶å€™ï¼Œä»è¯¥å…ƒç´ æ ¹èŠ‚ç‚¹å¼€å§‹é€çº§å‘é‡Œå¯»æ‰¾åŒç±»å‹äº‹ä»¶ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æˆä¸ºäº‹ä»¶æ•è·ã€‚

å¦‚`[äº‹ä»¶å†’æ³¡]`æ‰€ç¤ºå›¾å¯ä»¥æ¨ç†ã€‚
åœ¨äº‹ä»¶å†’æ³¡ä¸­ï¼Œç‚¹å‡»`div3`ä¼˜å…ˆè§¦å‘çš„å¹¶ä¸æ˜¯å…¶`click`äº‹ä»¶ï¼Œè€Œå…ˆè§¦å‘`div1`çš„`click`äº‹ä»¶ï¼Œå†åˆ°`div2`ï¼Œæœ€åæ‰æ˜¯`div3`

# å†’æ³¡-æ•è·æ€»ç»“

äº‹ä»¶å†’æ³¡æ˜¯**å‘ä¸Šçš„**ï¼Œäº‹ä»¶æ•è·æ˜¯**å‘ä¸‹çš„**ã€‚

äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·æœ¬èº«å¹¶ä¸ä¸»åŠ¨è§¦å‘äº‹ä»¶ã€‚éœ€è¦æˆ‘ä»¬å†³å®šäº‹ä»¶åœ¨å†’æ³¡é˜¶æ®µæ‰§è¡Œè¿˜æ˜¯åœ¨æ•è·é˜¶æ®µæ‰§è¡Œã€‚

å¦‚ä½•å†³å®šï¼Ÿ
`addEventListenner`ç”¨äºäº‹ä»¶ç»‘å®š
>[!info]
>```javascript
addEventListener(type, listener);
addEventListener(type, listener, options);
addEventListener(type, listener, useCapture);
>```
>**å‚æ•°**
>- `type`
>è¡¨ç¤ºç›‘å¬äº‹ä»¶ç±»å‹çš„å¤§å°å†™æ•æ„Ÿçš„å­—ç¬¦ä¸²
>- `listener`
>å½“æ‰€ç›‘å¬çš„äº‹ä»¶ç±»å‹è§¦å‘æ—¶ï¼Œä¼šæ¥æ”¶åˆ°ä¸€ä¸ªæ—¶é—´é€šçŸ¥ã€‚`listener`å¿…é¡»æ˜¯ä¸€ä¸ªå®ç°äº†`EventListener`æ¥å£çš„å¯¹è±¡ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚
>- `options` #å¯é€‰ 
>ä¸€ä¸ªæŒ‡å®šæœ‰å…³`listener`å±æ€§çš„å¯é€‰å‚æ•°å¯¹è±¡ã€‚å¯é€‰çš„é€‰é¡¹å¦‚ä¸‹ï¼š
>	`capture` #å¯é€‰
> ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºÂ `listener`Â ä¼šåœ¨è¯¥ç±»å‹çš„äº‹ä»¶æ•è·é˜¶æ®µä¼ æ’­åˆ°è¯¥Â `EventTarget`Â æ—¶è§¦å‘ã€‚
>	`once` #å¯é€‰ 
> ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºÂ `listener`Â åœ¨æ·»åŠ ä¹‹åæœ€å¤šåªè°ƒç”¨ä¸€æ¬¡ã€‚å¦‚æœä¸ºÂ `true`ï¼Œ`listener`Â ä¼šåœ¨å…¶è¢«è°ƒç”¨ä¹‹åè‡ªåŠ¨ç§»é™¤ã€‚
>	`passive` #å¯é€‰ 
> ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè®¾ç½®ä¸ºÂ `true`Â æ—¶ï¼Œè¡¨ç¤ºÂ `listener`Â æ°¸è¿œä¸ä¼šè°ƒç”¨Â `preventDefault()`ã€‚å¦‚æœ listener ä»ç„¶è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå®¢æˆ·ç«¯å°†ä¼šå¿½ç•¥å®ƒå¹¶æŠ›å‡ºä¸€ä¸ªæ§åˆ¶å°è­¦å‘Šã€‚
> - `useCaptrue` #å¯é€‰ 
> ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåœ¨ DOM æ ‘ä¸­æ³¨å†Œäº†Â `listener`Â çš„å…ƒç´ ï¼Œæ˜¯å¦è¦å…ˆäºå®ƒä¸‹é¢çš„Â `EventTarget`Â è°ƒç”¨è¯¥Â `listener`ã€‚å½“ useCaptureï¼ˆè®¾ä¸º trueï¼‰æ—¶ï¼Œæ²¿ç€ DOM æ ‘å‘ä¸Šå†’æ³¡çš„äº‹ä»¶ä¸ä¼šè§¦å‘ listenerã€‚å½“ä¸€ä¸ªå…ƒç´ åµŒå¥—äº†å¦ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”ä¸¤ä¸ªå…ƒç´ éƒ½å¯¹åŒä¸€äº‹ä»¶æ³¨å†Œäº†ä¸€ä¸ªå¤„ç†å‡½æ•°æ—¶ï¼Œæ‰€å‘ç”Ÿçš„äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·æ˜¯ä¸¤ç§ä¸åŒçš„äº‹ä»¶ä¼ æ’­æ–¹å¼ã€‚äº‹ä»¶ä¼ æ’­æ¨¡å¼å†³å®šäº†å…ƒç´ ä»¥å“ªä¸ªé¡ºåºæ¥æ”¶äº‹ä»¶ã€‚

![[eventflow.svg]]
è¿™ä¸‹æˆ‘ä»¬æ¥è¯•è¯•è¿™ä¸ª`useCaptrue`å‚æ•°æ¥è°ƒæ•´äº‹ä»¶æ•è·oräº‹ä»¶å†’æ³¡
```html
<div class="div1">
	div1
	<div class="div2">
		div2
		<div class="div3">div3</div>
	</div>
</div>
<script>
	function click1() {
		console.log('click div1')
	}
	function click2() {
		console.log('click div2')
	}
	function click3() {
		console.log('click div3')
	}
	document.querySelector('.div1').addEventListener('click', click1, true)
	document.querySelector('.div2').addEventListener('click', click2, true)
	document.querySelector('.div3').addEventListener('click', click3, true)
</script>
```
![[Pasted image 20240510220731.png]]

`useCaptrue`å‚æ•°ä¸º`false`æ—¶åœ¨äº‹ä»¶å†’æ³¡é˜¶æ®µå±•ç¤º
**é»˜è®¤æƒ…å†µä¹Ÿåœ¨å†’æ³¡é˜¶æ®µ**
### whyï¼Ÿä¸ºä»€ä¹ˆæœ‰ä¸¤ä¸ªæœºåˆ¶å‘¢ï¼Ÿ
>[!info]
>äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·ä¼¼ä¹å­˜åœ¨ä¸€ä¸ªå°±å¤Ÿäº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæœ‰ä¸¤å¥—æ¦‚å¿µå‘¢ï¼Ÿ
>å› ä¸ºäº‹ä»¶å†’æ³¡ç”±å¾®è½¯æå‡ºï¼Œäº‹ä»¶æ•è·ç”±ç½‘æ™¯æå‡ºï¼Œä¸ä¾¿å»é™¤å…¶ä¸€ï¼Œäºæ˜¯ä¾¿ç•™ä¸‹æ¥äº†ã€‚
# äº‹ä»¶ä»£ç†
## ä»€ä¹ˆæ˜¯äº‹ä»¶ä»£ç†ï¼Ÿ
>[!info]
>äº‹ä»¶ä»£ç†å°±æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡æˆ–äº‹ä»¶æ•è·æœºåˆ¶æŠŠä¸€ç³»åˆ—çš„å†…å±‚å…ƒç´ äº‹ä»¶ç»‘å®šåˆ°å¤–å±‚å…ƒç´ ã€‚è¿™å°±æ„å‘³ç€å­å…ƒç´ æœ¬èº«å°†ä¸å†æ³¨å†Œè‡ªå·±çš„äº‹ä»¶ã€‚

ğŸŒ°ï¼š
```html
<div class="div1">
	div1
	<div class="div2">
		div2
		<div class="div3">div3</div>
	</div>
</div>
<script>
	function clickIt(e) {
		const curDiv = e.target.getAttribute('class') //* è·å–å½“å‰ç‚¹å‡»çš„divçš„class
		console.log(curDiv)
	}
	document.querySelector('.div1').addEventListener('click', clickIt)
</script>
```
![[Pasted image 20240510222615.png]]
ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬åªæœ‰`div1`è¢«ç»‘å®šäº†äº‹ä»¶ã€‚
**æ— è®ºæ˜¯äº‹ä»¶å†’æ³¡è¿˜æ˜¯äº‹ä»¶æ•è·ï¼Œéƒ½å¯ä»¥è¿›è¡Œäº‹ä»¶ä»£ç†**
# é˜»æ­¢äº‹ä»¶å†’æ³¡/æ•è·
```javascript
  event.stopPropagation()
```